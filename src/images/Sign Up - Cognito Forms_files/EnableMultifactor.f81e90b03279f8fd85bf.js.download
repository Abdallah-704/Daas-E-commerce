(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{1003:function(e,t,a){var n=a(1402);n.__esModule&&(n=n.default),"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);(0,a(177).default)("78a84bb9",n,!0,{})},1401:function(e,t,a){"use strict";a(1003)},1402:function(e,t,a){(t=a(176)(!1)).push([e.i,".enable-multi-factor__container{border:1px solid #dfeaea;padding:1rem 1.75rem}.enable-multi-factor__container a{color:#00b3ab}",""]),e.exports=t},1907:function(e,t,a){"use strict";a.r(t);a(422),a(178),a(421);var n=a(1252),i=a(757),o=a(149),l=a(1002),r=a(113),u=a(711),s=a(708),c=a(716),d=a(706),f=a(709),b=a.n(f),p=a(20),v=a(45),m=a(679),g=Object(p.defineComponent)({components:{CMultifactorSecret:n.a,CMultifactorInput:i.a,ValidationObserver:u.ValidationObserver,CStatusButton:s.default,CValidatedInput:c.default,CCallout:d.default},props:{token:{type:String,default:""},rememberMe:{type:Boolean,default:!1},encryptedAuthMethod:{type:String,default:null}},setup:function(e,t){t.emit;var a=Object(p.ref)(""),n=Object(p.ref)(""),i=Object(p.ref)(""),s=Object(p.ref)(!1),c=Object(p.ref)(!1),d=Object(p.ref)(!1),f=Object(p.ref)(null),g=Object(p.ref)(""),C=Object(p.ref)(""),h=Object(p.ref)(!1),O=Object(p.ref)("");Object(p.watch)(O,(function(e){e&&(h.value=!1)}));var _=Object(p.computed)((function(){return c.value?"validating":s.value&&h.value?"error":"default"})),j=Object(m.useRoute)(),w=Object(p.ref)(null);return Object(u.extend)("is-not-same-email",{validate:function(e){return f.value!==e},message:"Your backup email address must be different from your account email address."}),v.CognitoConfiguration.NewLoginEnabled?(C.value=j.query.desiredOrganization,Object(l.initEnableMultifactor)(C.value).then((function(e){a.value=e.Secret,n.value=e.SetupUrl,f.value=e.UserEmail}))):Object(o.initiatePublicMfaSetup)(e.token).then((function(e){a.value=e.SetupCode.Secret,n.value=e.SetupCode.SetupUrl,f.value=e.UserEmail,C.value=e.OrganizationName})),{secret:a,setupUrl:n,backupEmailAddress:O,password:i,isCodeValidated:s,isLoading:c,isValidatingInput:d,otp:g,organization:C,hasError:h,status:_,validateCode:function(e){d.value=!0,Object(o.validateTempOtp)(a.value,e).then((function(t){d.value=!1,s.value=t,g.value=e}))},handleEnableMfa:function(){var t=function(e){400===e.statusCode?e.message.toLowerCase().includes("email")?(w.value.setErrors({"email-address":e.message}),h.value=!0):"session is null."===e.message.toLowerCase()&&window.location.assign("/login"):b()("An error has occured","error")};v.CognitoConfiguration.NewLoginEnabled?Object(l.enableMultifactor)(O.value,a.value,g.value,j.query.organizationCode).then((function(){window.location.assign(j.query.returnUrl)})).catch((function(e){return t(e)})):Object(o.enableMfa)(a.value,O.value,g.value,e.token).then((function(){var t;t=g.value,c.value=!0,Object(r.multifactorLogin)(e.token,t,e.rememberMe,null,null,null,null,null,e.encryptedAuthMethod).then((function(e){e.Succeeded?setTimeout((function(){return window.location.assign(e.ReturnUrl)}),500):c.value=!1})).catch((function(){c.value=!1}))})).catch((function(e){return t(e)}))},CognitoConfiguration:v.CognitoConfiguration}}}),C=(a(1401),a(67)),h=Object(C.a)(g,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"enable-multi-factor social-login__form"},[e.CognitoConfiguration.NewLoginEnabled?t("c-callout",{attrs:{type:"info"}},[t("p",[e._v(e._s(e.organization)+" requires two-factor authentication.")])]):t("div",{staticClass:"sz-2 bg-harriet p-3 mb-2"},[t("p",[e._v(e._s(e.organization)+" requires two-factor authentication.")])]),e._v(" "),t("div",{staticClass:"enable-multi-factor__container"},[e.secret?t("c-multifactor-secret",{attrs:{secret:e.secret,"setup-url":e.setupUrl}}):e._e(),e._v(" "),t("c-multifactor-input",{attrs:{"is-validated":e.isCodeValidated,"is-loading":e.isValidatingInput},on:{complete:e.validateCode}})],1),e._v(" "),t("ValidationObserver",{ref:"observer",staticClass:"cog-form",attrs:{tag:"form",novalidate:"","data-vv-scope":"observer"},on:{submit:function(t){return t.preventDefault(),e.handleEnableMfa.apply(null,arguments)}}},[t("c-validated-input",{ref:"email",staticClass:"mt-4 mb-2",attrs:{id:"email-address",vid:"email-address",type:"email",name:"Backup Email Address",placeholder:"Backup Email Address",autocomplete:"on",rules:"required|email|is-not-same-email"},model:{value:e.backupEmailAddress,callback:function(t){e.backupEmailAddress="string"==typeof t?t.trim():t},expression:"backupEmailAddress"}}),e._v(" "),t("div",{staticClass:"helptext text-1"},[e._v("This backup email will be used to send authentication codes when you cannot access your authenticator app.")]),e._v(" "),t("div",{staticClass:"dialog__footer flex flex--sb flex--end"},[t("c-status-button",{staticClass:"button button--primary bg-deep sz-4 my-3",attrs:{status:e.status,disabled:!e.isCodeValidated||e.hasError,type:"submit"}},[e._v("\n\t\t\t\tEnable\n\t\t\t")])],1)],1)],1)}),[],!1,null,null,null);t.default=h.exports}}]);
//# sourceMappingURL=EnableMultifactor.f81e90b03279f8fd85bf.js.map