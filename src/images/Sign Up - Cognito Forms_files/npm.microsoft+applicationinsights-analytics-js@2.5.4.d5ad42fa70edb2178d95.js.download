(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{704:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var r=i(19),n=i(31),a=i(29),o=i(395),s=i(391),c=i(412),l=i(408),g=i(392),p=i(413),u=i(409),d=i(394),f=i(411),h=i(24),m=i(25),v=i(18),T=i(416),w=i(87),y=function e(t,i,r,n){Object(w.a)(e,this,(function(e){var o,s=v.a.arrForEach,c=v.a.isNullOrUndefined,l=null,g=[],p=!1;function u(){r&&s(r.getTransmissionControls(),(function(e){s(e,(function(e){return e.flush(!0)}))}))}r&&(o=r.logger),e.trackPageView=function(e,r){var d=e.name;if(c(d)||"string"!=typeof d){var f=Object(h.a)();d=e.name=f&&f.title||""}var v=e.uri;if(c(v)||"string"!=typeof v){var T=Object(h.f)();v=e.uri=T&&T.href||""}if(!n.isPerformanceTimingSupported())return t.sendPageViewInternal(e,r),u(),void o.throwInternal(m.a.WARNING,m.b.NavigationTimingNotSupported,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var w,y,k,P=!1,b=n.getPerformanceTiming().navigationStart;w=a.c.GetDuration(b,+new Date),n.shouldCollectDuration(w)||(w=void 0),c(r)||c(r.duration)||(y=r.duration),!i&&isNaN(y)||(isNaN(y)&&(r||(r={}),r.duration=w),t.sendPageViewInternal(e,r),u(),P=!0),r||(r={}),k=function(){var i=!1;try{if(n.isPerformanceTimingDataReady()){i=!0;var s={name:d,uri:v};n.populatePageViewPerformanceEvent(s),s.isValid||P?(P||(r.duration=s.durationMs,t.sendPageViewInternal(e,r)),p||(t.sendPageViewPerformanceInternal(s,r),p=!0)):(r.duration=w,t.sendPageViewInternal(e,r))}else a.c.GetDuration(b,+new Date)>6e4&&(i=!0,P||(r.duration=6e4,t.sendPageViewInternal(e,r)))}catch(e){o.throwInternal(m.a.CRITICAL,m.b.TrackPVFailedCalc,"trackPageView failed on page load calculation: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}return i},g.push(k),l||(l=setInterval((function(){var e=g.slice(0),t=!1;g=[],s(e,(function(e){e()?t=!0:g.push(e)})),0===g.length&&(clearInterval(l),l=null),t&&u()}),100))}}))},k=function(){function e(e,t){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=t,this._logger=e}return e.prototype.trackPreviousPageVisit=function(e,t){try{var i=this.restartPageVisitTimer(e,t);i&&this.pageVisitTimeTrackingHandler(i.pageName,i.pageUrl,i.pageVisitTime)}catch(e){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+a.e.dump(e))}},e.prototype.restartPageVisitTimer=function(e,t){try{var i=this.stopPageVisitTimer();return this.startPageVisitTimer(e,t),i}catch(e){return this._logger.warnToConsole("Call to restart failed: "+a.e.dump(e)),null}},e.prototype.startPageVisitTimer=function(e,t){try{if(a.e.canUseSessionStorage()){if(null!=a.e.getSessionStorage(this._logger,this.prevPageVisitDataKeyName))throw new Error("Cannot call startPageVisit consecutively without first calling stopPageVisit");var i=new P(e,t),r=Object(h.e)().stringify(i);a.e.setSessionStorage(this._logger,this.prevPageVisitDataKeyName,r)}}catch(e){this._logger.warnToConsole("Call to start failed: "+a.e.dump(e))}},e.prototype.stopPageVisitTimer=function(){try{if(a.e.canUseSessionStorage()){var e=Date.now(),t=a.e.getSessionStorage(this._logger,this.prevPageVisitDataKeyName);if(t&&Object(h.k)()){var i=Object(h.e)().parse(t);return i.pageVisitTime=e-i.pageVisitStartTime,a.e.removeSessionStorage(this._logger,this.prevPageVisitDataKeyName),i}return null}return null}catch(e){return this._logger.warnToConsole("Stop page visit timer failed: "+a.e.dump(e)),null}},e}(),P=function(e,t){this.pageVisitStartTime=Date.now(),this.pageName=e,this.pageUrl=t},b=function(){function e(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return e.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceNavigationTiming(),i=this.getPerformanceTiming();if(t||i){if(t)var r=t.duration,n=a.c.GetDuration(t.startTime,t.connectEnd),o=a.c.GetDuration(t.requestStart,t.responseStart),s=a.c.GetDuration(t.responseStart,t.responseEnd),c=a.c.GetDuration(t.responseEnd,t.loadEventEnd);else r=a.c.GetDuration(i.navigationStart,i.loadEventEnd),n=a.c.GetDuration(i.navigationStart,i.connectEnd),o=a.c.GetDuration(i.requestStart,i.responseStart),s=a.c.GetDuration(i.responseStart,i.responseEnd),c=a.c.GetDuration(i.responseEnd,i.loadEventEnd);0===r?this._logger.throwInternal(m.a.WARNING,m.b.ErrorPVCalc,"error calculating page view performance.",{total:r,network:n,request:o,response:s,dom:c}):this.shouldCollectDuration(r,n,o,s,c)?r<Math.floor(n)+Math.floor(o)+Math.floor(s)+Math.floor(c)?this._logger.throwInternal(m.a.WARNING,m.b.ClientPerformanceMathError,"client performance math error.",{total:r,network:n,request:o,response:s,dom:c}):(e.durationMs=r,e.perfTotal=e.duration=a.e.msToTimeSpan(r),e.networkConnect=a.e.msToTimeSpan(n),e.sentRequest=a.e.msToTimeSpan(o),e.receivedResponse=a.e.msToTimeSpan(s),e.domProcessing=a.e.msToTimeSpan(c),e.isValid=!0):this._logger.throwInternal(m.a.WARNING,m.b.InvalidDurationValue,"Invalid page load duration value. Browser perf data won't be sent.",{total:r,network:n,request:o,response:s,dom:c})}},e.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?Object(h.h)().timing:null},e.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?Object(h.h)().getEntriesByType("navigation")[0]:null},e.prototype.isPerformanceNavigationTimingSupported=function(){var e=Object(h.h)();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},e.prototype.isPerformanceTimingSupported=function(){var e=Object(h.h)();return e&&e.timing},e.prototype.isPerformanceTimingDataReady=function(){var e=Object(h.h)(),t=e?e.timing:0;return t&&t.domainLookupStart>0&&t.navigationStart>0&&t.responseStart>0&&t.requestStart>0&&t.loadEventEnd>0&&t.responseEnd>0&&t.connectEnd>0&&t.domLoading>0},e.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=Object(h.g)()||{},r=["googlebot","adsbot-google","apis-google","mediapartners-google"],n=i.userAgent,a=!1;if(n)for(var o=0;o<r.length;o++)a=a||-1!==n.toLowerCase().indexOf(r[o]);if(a)return!1;for(o=0;o<e.length;o++)if(e[o]>=this.MAX_DURATION_ALLOWED)return!1;return!0},e}();function E(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}var I=function(e){function t(){var t=e.call(this)||this;t.identifier=n.AnalyticsPluginIdentifier,t.priority=180,t.autoRoutePVDelay=500,t._trackAjaxAttempts=0;var i=Object(h.f)();return t._prevUri=i&&i.href||"",t}return r.b(t,e),t.getDefaultConfig=function(e){return e||(e={}),e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=a.e.stringToBoolOrDefault(e.disableExceptionTracking),e.autoTrackPageVisitTime=a.e.stringToBoolOrDefault(e.autoTrackPageVisitTime),e.overridePageViewDuration=a.e.stringToBoolOrDefault(e.overridePageViewDuration),e.enableUnhandledPromiseRejectionTracking=a.e.stringToBoolOrDefault(e.enableUnhandledPromiseRejectionTracking),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.isCookieUseDisabled=a.e.stringToBoolOrDefault(e.isCookieUseDisabled),e.isStorageUseDisabled=a.e.stringToBoolOrDefault(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=a.e.stringToBoolOrDefault(e.isBrowserLinkTrackingEnabled),e.enableAutoRouteTracking=a.e.stringToBoolOrDefault(e.enableAutoRouteTracking),e.namePrefix=e.namePrefix||"",e},t.prototype.processTelemetry=function(e,t){var i=!1,r=this._telemetryInitializers.length;t=this._getTelCtx(t);for(var n=0;n<r;++n){var o=this._telemetryInitializers[n];if(o)try{if(!1===o.apply(null,[e])){i=!0;break}}catch(e){t.diagLog().throwInternal(m.a.CRITICAL,m.b.TelemetryInitializerFailed,"One of telemetry initializers failed, telemetry item will not be sent: "+a.e.getExceptionName(e),{exception:a.e.dump(e)},!0)}}i||this.processNext(e,t)},t.prototype.trackEvent=function(e,t){try{var i=o.a.create(e,s.a.dataType,s.a.envelopeType,this.diagLog(),t);this.core.track(i)}catch(e){this.diagLog().throwInternal(m.a.WARNING,m.b.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.startTrackEvent=function(e){try{this._eventTracking.start(e)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.StartTrackEventFailed,"startTrackEvent failed, event will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.stopTrackEvent=function(e,t,i){try{this._eventTracking.stop(e,void 0,t)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.StopTrackEventFailed,"stopTrackEvent failed, event will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.trackTrace=function(e,t){try{var i=o.a.create(e,c.a.dataType,c.a.envelopeType,this.diagLog(),t);this.core.track(i)}catch(e){this.diagLog().throwInternal(m.a.WARNING,m.b.TrackTraceFailed,"trackTrace failed, trace will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.trackMetric=function(e,t){try{var i=o.a.create(e,l.a.dataType,l.a.envelopeType,this.diagLog(),t);this.core.track(i)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.TrackMetricFailed,"trackMetric failed, metric will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.trackPageView=function(e,t){try{var i=e||{};this._pageViewManager.trackPageView(i,r.a({},i.properties,i.measurements,t)),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(i.name,i.uri)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.TrackPVFailed,"trackPageView failed, page view will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.sendPageViewInternal=function(e,t,i){var r=Object(h.a)();r&&(e.refUri=void 0===e.refUri?r.referrer:e.refUri);var n=o.a.create(e,g.a.dataType,g.a.envelopeType,this.diagLog(),t,i);this.core.track(n),this._trackAjaxAttempts=0},t.prototype.sendPageViewPerformanceInternal=function(e,t,i){var r=o.a.create(e,p.a.dataType,p.a.envelopeType,this.diagLog(),t,i);this.core.track(r)},t.prototype.trackPageViewPerformance=function(e,t){try{this._pageViewPerformanceManager.populatePageViewPerformanceEvent(e),this.sendPageViewPerformanceInternal(e,t)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.TrackPVFailed,"trackPageViewPerformance failed, page view will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.startTrackPage=function(e){try{if("string"!=typeof e){var t=Object(h.a)();e=t&&t.title||""}this._pageTracking.start(e)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.StartTrackFailed,"startTrackPage failed, page view may not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.stopTrackPage=function(e,t,i,r){try{if("string"!=typeof e){var n=Object(h.a)();e=n&&n.title||""}if("string"!=typeof t){var o=Object(h.f)();t=o&&o.href||""}this._pageTracking.stop(e,t,i,r),this.config.autoTrackPageVisitTime&&this._pageVisitTimeManager.trackPreviousPageVisit(e,t)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.StopTrackFailed,"stopTrackPage failed, page view will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype.sendExceptionInternal=function(e,t,i){var r=new u.a(this.diagLog(),e.exception||new Error(a.e.NotSpecified),e.properties,e.measurements,e.severityLevel,e.id).toInterface(),n=o.a.create(r,u.a.dataType,u.a.envelopeType,this.diagLog(),t,i);this.core.track(n)},t.prototype.trackException=function(e,t){try{this.sendExceptionInternal(e,t)}catch(e){this.diagLog().throwInternal(m.a.CRITICAL,m.b.TrackExceptionFailed,"trackException failed, exception will not be collected: "+a.e.getExceptionName(e),{exception:a.e.dump(e)})}},t.prototype._onerror=function(e){try{var t={url:e&&e.url||(Object(h.a)()||{}).URL,lineNumber:e.lineNumber,columnNumber:e.columnNumber,message:e.message};if(a.e.isCrossOriginError(e.message,e.url,e.lineNumber,e.columnNumber,e.error))this._sendCORSException(t.url);else{if(!a.e.isError(e.error)){var i="window.onerror@"+t.url+":"+e.lineNumber+":"+(e.columnNumber||0);e.error=new Error(e.message),e.error.stack=i}this.trackException({exception:e.error,severityLevel:d.a.Error},t)}}catch(t){var r=e.error?e.error.name+", "+e.error.message:"null";this.diagLog().throwInternal(m.a.CRITICAL,m.b.ExceptionWhileLoggingError,"_onError threw exception while logging error, error will not be collected: "+a.e.getExceptionName(t),{exception:a.e.dump(t),errorString:r})}},t.prototype.addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},t.prototype.initialize=function(i,r,o,s){var c=this;if(!this.isInitialized()){if(v.a.isNullOrUndefined(r))throw Error("Error initializing");e.prototype.initialize.call(this,i,r,o,s),this.setInitialized(!1);var l=this._getTelCtx(),g=this.identifier;this._globalconfig={instrumentationKey:i.instrumentationKey,endpointUrl:i.endpointUrl||"https://dc.services.visualstudio.com/v2/track"},this.config=l.getExtCfg(g);var p=t.getDefaultConfig();if(void 0!==p){for(var u in p)this.config[u]=l.getConfig(g,u,p[u]);if(this._globalconfig)for(var u in p)void 0===this._globalconfig[u]&&(this._globalconfig[u]=p[u])}this.config.isCookieUseDisabled&&a.e.disableCookies(),this.config.isStorageUseDisabled&&a.e.disableStorage();var d={instrumentationKey:function(){return i.instrumentationKey},accountId:function(){return c.config.accountId||i.accountId},sessionRenewalMs:function(){return c.config.sessionRenewalMs||i.sessionRenewalMs},sessionExpirationMs:function(){return c.config.sessionExpirationMs||i.sessionExpirationMs},sampleRate:function(){return c.config.samplingPercentage||i.samplingPercentage},cookieDomain:function(){return c.config.cookieDomain||i.cookieDomain},sdkExtension:function(){return c.config.sdkExtension||i.sdkExtension},isBrowserLinkTrackingEnabled:function(){return c.config.isBrowserLinkTrackingEnabled||i.isBrowserLinkTrackingEnabled},appId:function(){return c.config.appId||i.appId}};this._pageViewPerformanceManager=new b(this.core),this._pageViewManager=new y(this,this.config.overridePageViewDuration,this.core,this._pageViewPerformanceManager),this._pageVisitTimeManager=new k(this.diagLog(),(function(e,t,i){return c.trackPageVisitTime(e,t,i)})),this._telemetryInitializers=this._telemetryInitializers||[],this._addDefaultTelemetryInitializers(d),this._eventTracking=new _(this.diagLog(),"trackEvent"),this._eventTracking.action=function(e,t,i,r){r||(r={}),r.duration=i.toString(),c.trackEvent({name:e,properties:r})},this._pageTracking=new _(this.diagLog(),"trackPageView"),this._pageTracking.action=function(e,t,i,r,n){v.a.isNullOrUndefined(r)&&(r={}),r.duration=i.toString();var a={name:e,uri:t,properties:r,measurements:n};c.sendPageViewInternal(a,r)};var f,m=Object(h.i)(),T=Object(h.d)(),w=Object(h.f)(),P=this;if(!1===this.config.disableExceptionTracking&&!this.config.autoExceptionInstrumented&&m){var I=m.onerror;m.onerror=function(e,t,i,r,n){var a=I&&I(e,t,i,r,n);return!0!==a&&P._onerror({message:e,url:t,lineNumber:i,columnNumber:r,error:n}),a},this.config.autoExceptionInstrumented=!0}if(!1===this.config.disableExceptionTracking&&!0===this.config.enableUnhandledPromiseRejectionTracking&&!this.config.autoUnhandledPromiseInstrumented&&m){var x=m.onunhandledrejection;m.onunhandledrejection=function(e){var t=x&&x.call(m,e);return!0!==t&&P._onerror({message:e.reason.toString(),error:e.reason instanceof Error?e.reason:new Error(e.reason.toString()),url:w?w.href:"",lineNumber:0,columnNumber:0}),t},this.config.autoUnhandledPromiseInstrumented=!0}if(!0===this.config.enableAutoRouteTracking&&T&&v.a.isFunction(T.pushState)&&v.a.isFunction(T.replaceState)&&m&&"undefined"!=typeof Event){var V=this;v.a.arrForEach(o,(function(e){e.identifier===n.PropertiesPluginIdentifier&&(c._properties=e)})),T.pushState=(f=T.pushState,function(){var e=f.apply(this,arguments);return E(m,a.e.createDomEvent(V.config.namePrefix+"pushState")),E(m,a.e.createDomEvent(V.config.namePrefix+"locationchange")),e}),T.replaceState=function(e){return function(){var t=e.apply(this,arguments);return E(m,a.e.createDomEvent(V.config.namePrefix+"replaceState")),E(m,a.e.createDomEvent(V.config.namePrefix+"locationchange")),t}}(T.replaceState),m.addEventListener&&(m.addEventListener(V.config.namePrefix+"popstate",(function(){E(m,a.e.createDomEvent(V.config.namePrefix+"locationchange"))})),m.addEventListener(V.config.namePrefix+"locationchange",(function(){V._properties&&V._properties.context&&V._properties.context.telemetryTrace&&(V._properties.context.telemetryTrace.traceID=a.e.generateW3CId(),V._properties.context.telemetryTrace.name=w&&w.pathname||"_unknown_"),c._currUri?(c._prevUri=c._currUri,c._currUri=w&&w.href||""):c._currUri=w&&w.href||"",setTimeout(function(e){V.trackPageView({refUri:e,properties:{duration:0}})}.bind(c,c._prevUri),V.autoRoutePVDelay)})))}this.setInitialized(!0)}},t.prototype.trackPageVisitTime=function(e,t,i){var r={PageName:e,PageUrl:t};this.trackMetric({name:"PageVisitTime",average:i,max:i,min:i,sampleCount:1},r)},t.prototype._addDefaultTelemetryInitializers=function(e){if(!e.isBrowserLinkTrackingEnabled()){var t=["/browserLinkSignalR/","/__browserLink/"];this._addTelemetryInitializer((function(e){if(e.baseType===f.a.dataType){var i=e.baseData;if(i)for(var r=0;r<t.length;r++)if(i.target&&i.target.indexOf(t[r])>=0)return!1}return!0}))}},t.prototype._addTelemetryInitializer=function(e){this._telemetryInitializers.push(e)},t.prototype._sendCORSException=function(e){var t={message:"Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",url:e,lineNumber:0,columnNumber:0,error:void 0},i=o.a.create(t,u.a.dataType,u.a.envelopeType,this.diagLog(),{url:e});this.core.track(i)},t.Version="2.5.4",t}(T.a),_=function(){function e(e,t){this._name=t,this._events={},this._logger=e}return e.prototype.start=function(e){void 0!==this._events[e]&&this._logger.throwInternal(m.a.WARNING,m.b.StartCalledMoreThanOnce,"start was called more than once for this event without calling stop.",{name:this._name,key:e},!0),this._events[e]=+new Date},e.prototype.stop=function(e,t,i,r){var n=this._events[e];if(isNaN(n))this._logger.throwInternal(m.a.WARNING,m.b.StopCalledWithoutStart,"stop was called without a corresponding start.",{name:this._name,key:e},!0);else{var o=+new Date,s=a.c.GetDuration(n,o);this.action(e,t,s,i,r)}delete this._events[e],this._events[e]=void 0},e}()}}]);
//# sourceMappingURL=npm.microsoft+applicationinsights-analytics-js@2.5.4.d5ad42fa70edb2178d95.js.map